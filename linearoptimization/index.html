<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Twitter cards -->
    <meta name="twitter:site"    content="@">
    <meta name="twitter:creator" content="@Maxime Labonne">
    <meta name="twitter:title"   content="Introduction to Linear Programming in Python">

    
    <meta name="twitter:description" content="Illustrated machine learning and deep learning tutorials with Python and PyTorch for programmers.">
    

    
    <meta name="twitter:card"  content="summary_large_image">
    <meta name="twitter:image" content="https://mlabonne.github.ioimages/linearoptimization/thumbnail.jpg">
    
  <!-- end of Twitter cards -->

  <!-- Pinterest -->
  <meta name="p:domain_verify" content="e8bbc84dbf0895d9267aad84438e86df"/>
  <!-- end of Pinterest--><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Introduction to Linear Programming in Python | Maxime Labonne</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Introduction to Linear Programming in Python" />
<meta name="author" content="Maxime Labonne" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A guide to mathematical optimization with Google OR-Tools" />
<meta property="og:description" content="A guide to mathematical optimization with Google OR-Tools" />
<link rel="canonical" href="https://mlabonne.github.io/blog/linearoptimization/" />
<meta property="og:url" content="https://mlabonne.github.io/blog/linearoptimization/" />
<meta property="og:site_name" content="Maxime Labonne" />
<meta property="og:image" content="https://mlabonne.github.io/blog/images/linearoptimization/thumbnail.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-02T00:00:00-06:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://mlabonne.github.io/blog/images/linearoptimization/thumbnail.jpg" />
<meta property="twitter:title" content="Introduction to Linear Programming in Python" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Maxime Labonne"},"dateModified":"2022-03-02T00:00:00-06:00","datePublished":"2022-03-02T00:00:00-06:00","description":"A guide to mathematical optimization with Google OR-Tools","headline":"Introduction to Linear Programming in Python","image":"https://mlabonne.github.io/blog/images/linearoptimization/thumbnail.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://mlabonne.github.io/blog/linearoptimization/"},"url":"https://mlabonne.github.io/blog/linearoptimization/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://mlabonne.github.io/blog/feed.xml" title="Maxime Labonne" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4DWYJM47PC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-4DWYJM47PC');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Maxime Labonne</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About</a><a class="page-link" href="/blog/publications/">Publications</a><a class="page-link" href="/blog/search/">🔎</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction to Linear Programming in Python</h1><p class="page-description">A guide to mathematical optimization with Google OR-Tools</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-02T00:00:00-06:00" itemprop="datePublished">
        <img src="/blog/images/icons/icon-watch.svg" class="icon-watch"> Mar 2, 2022
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Maxime Labonne</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      9 min read
    
</span>• <a href= https://colab.research.google.com/drive/1dbrFJwFv80kgUi13MfPO3KyumG-SVIHG?usp=sharing target="_blank"> <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"></a>
    </p>

    

    <!-- 
      
        <div class="badges">
          <div class="runthecode">
            Run the code along the article without installating anything
          </div>
          <div class="d-flex flex-justify-center">
            <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fmlabonne%2Fblog%2Fblob%2Fmaster%2F_notebooks%2F2022-03-02-Linear_Programming.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/blog/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

            <div class="px-2">
    <a href="https://colab.research.google.com/github/mlabonne/blog/blob/master/_notebooks/2022-03-02-Linear_Programming.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
            <div class="px-2">
    <a href="https://mybinder.org/v2/gh/mlabonne/blog/master?filepath=_notebooks%2F2022-03-02-Linear_Programming.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

            <div class="px-2">

    <a href="https://github.com/mlabonne/blog/tree/master/_notebooks/2022-03-02-Linear_Programming.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          </div>
        </div>
      -->
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-03-02-Linear_Programming.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<center><img src="https://mlabonne.github.io/blog/images/linearoptimization/thumbnail.jpg" /></center><p>Linear programming is a technique to <strong>optimize any problem</strong> with multiple variables and constraints. It's a simple but powerful tool every data scientist should master.</p>
<p>Imagine you are a strategist recruiting an army. You have:</p>
<ul>
<li><strong>Three resources</strong>: 🌾food, 🪵wood, and 🪙gold</li>
<li><strong>Three units</strong>: 🗡️swordsmen, 🏹bowmen, and 🐎horsemen.</li>
</ul>
<p>Horsemen are stronger than bowmen, who are in turn stronger than swordsmen. The following table provides the cost and power of each unit:</p>
<table>
<thead><tr>
<th style="text-align:left">Unit</th>
<th style="text-align:center">🌾Food</th>
<th style="text-align:center">🪵Wood</th>
<th style="text-align:center">🪙Gold</th>
<th style="text-align:center">💪Power</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">🗡️Swordsman</td>
<td style="text-align:center">60</td>
<td style="text-align:center">20</td>
<td style="text-align:center">0</td>
<td style="text-align:center">70</td>
</tr>
<tr>
<td style="text-align:left">🏹Bowman</td>
<td style="text-align:center">80</td>
<td style="text-align:center">10</td>
<td style="text-align:center">40</td>
<td style="text-align:center">95</td>
</tr>
<tr>
<td style="text-align:left">🐎Horseman</td>
<td style="text-align:center">140</td>
<td style="text-align:center">0</td>
<td style="text-align:center">100</td>
<td style="text-align:center">230</td>
</tr>
</tbody>
</table>
<p>Now we have 1200 🌾food, 800 🪵wood, and 600 🪙gold. How should we <strong>maximize the power of our army</strong> considering these resources?</p>
<p>We could simply find the unit with the best power/cost ratio, take as many of them as possible, and repeat the process with the other two units. But this "guess and check" solution might <strong>not even be optimal</strong>...</p>
<p>Now imagine we have <strong>millions of units and resources</strong>: the previous greedy strategy is likely to completely miss the optimal solution. It is possible to use a machine learning algorithm (e.g., a genetic algorithm) to solve this problem, but we have no guarantee that the solution will be optimal either.</p>
<p>Fortunately for us, there is a method that can solve our problem in an optimal way: <strong>linear programming</strong> (or linear optimization), which is part of the field of <a href="https://en.wikipedia.org/wiki/Operations_research">operations research</a> (OR). In this article, we'll use it to find the best numbers of swordsmen, bowmen, and horsemen to build the <strong>army with the highest power possible</strong>.</p>
<p>You can run the code from this tutorial with the following <a href="https://colab.research.google.com/drive/1dbrFJwFv80kgUi13MfPO3KyumG-SVIHG?usp=sharing"><strong>Google Colab notebook</strong></a>.</p>
<h2 id="&#129504;-I.&#160;Solvers">&#129504; I.&#160;Solvers<a class="anchor-link" href="#&#129504;-I.&#160;Solvers"> </a></h2><p>In Python, there are different libraries for linear programming such as the multi-purposed <strong>SciPy</strong>, the beginner-friendly <strong>PuLP</strong>, the exhaustive <strong>Pyomo</strong>, and many others.</p>
<p>Today, we are going to use <a href="https://developers.google.com/optimization"><strong>Google OR-Tools</strong></a>, which is quite user-friendly, comes with several prepackaged solvers, and has by far the most stars on <a href="https://github.com/google/or-tools">GitHub</a>.</p>
<p>If the installation doesn't work, please restart the kernel and try again: it can fail sometimes. ¯\_(ツ)_/¯</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="o">--</span><span class="n">user</span> <span class="o">-</span><span class="n">q</span> <span class="n">ortools</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All these libraries have a hidden benefit: they act as interfaces to <strong>use the same model with different solvers</strong>. Solvers like <a href="https://www.gurobi.com/">Gurobi</a>, <a href="https://www.ibm.com/analytics/cplex-optimizer">Cplex</a>, or <a href="https://www.scipopt.org/">SCIP</a> have their own APIs, but the models they create are <strong>tied to a specific solver</strong>.</p>
<p>OR-Tools allows us to use an abstract (and quite pythonic) way of modeling our problems. We can then choose <strong>one or several solvers</strong> to find an optimal solution. The model we built is thus highly reusable!</p>
<center class="dark-bg">
    <video autoplay="" loop="" muted="" width="800" class="no-margin">
        <source src="https://mlabonne.github.io/blog/images/linearoptimization/solvers.mp4" type="video/mp4" />&lt;/source&gt;
    </video>
</center><p>OR-Tools comes with its own linear programming solver, called <strong>GLOP</strong> (Google Linear Optimization Package). It is an open-source project created by Google's Operations Research Team and written in C++.</p>
<p>Other solvers are available such as <strong>SCIP</strong>, an excellent non-commercial solver created in 2005 and updated and maintained to this day. We could also use popular commercial options like <strong>Gurobi</strong> and <strong>Cplex</strong>. However, we would need to install them on top of OR-Tools and get the appropriate licenses (which can be quite costly). For now, let's try GLOP.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">ortools.linear_solver</span> <span class="kn">import</span> <span class="n">pywraplp</span>

<span class="c1"># Create a solver using the GLOP backend</span>
<span class="n">solver</span> <span class="o">=</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="p">(</span><span class="s1">&#39;Maximize army power&#39;</span><span class="p">,</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">GLOP_LINEAR_PROGRAMMING</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#129518;-II.-Variables">&#129518; II. Variables<a class="anchor-link" href="#&#129518;-II.-Variables"> </a></h2><p>We created an instance of the OR-Tools solver using GLOP. Now, how to use linear programming? The first thing we want to define is the <strong>variables we want to optimize</strong>.</p>
<p>In our example, we have three variables: the number of 🗡️swordsmen, 🏹bowmen, and 🐎horsemen in the army. OR-Tools accepts three types of variables:</p>
<ul>
<li><code>NumVar</code> for <strong>continuous</strong> variables;</li>
<li><code>IntVar</code> for <strong>integer</strong> variables;</li>
<li><code>BoolVar</code> for <strong>boolean</strong> variables.</li>
</ul>
<p>We're looking for <strong>round numbers</strong> of units, so let's choose <code>IntVar</code>. We then need to specify lower and upper bounds for these variables. We want at least 0 unit, but we don't really have an upper bound. So we can say that our upper bound is infinity (or any big number we will never reach). It can be written as:</p>
$$0 \leq swordsmen &lt; \infty \\
0 \leq bowmen &lt; \infty \\
0 \leq horsemen &lt; \infty$$<p>Let's translate it into code. Infinity is replaced by <code>solver.infinity()</code> in OR-Tools. Other than that, the syntax is <strong>quite straightforward</strong>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">swordsmen</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;swordsmen&#39;</span><span class="p">)</span>
<span class="n">bowmen</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;bowmen&#39;</span><span class="p">)</span>
<span class="n">horsemen</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">solver</span><span class="o">.</span><span class="n">infinity</span><span class="p">(),</span> <span class="s1">&#39;horsemen&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#9939;&#65039;-III.-Constraints">&#9939;&#65039; III. Constraints<a class="anchor-link" href="#&#9939;&#65039;-III.-Constraints"> </a></h2><p>We defined our variables, but the <strong>constraints</strong> are just as important.</p>
<p>Perhaps counter-intuitively, adding more constraints helps the solver to <strong>find an optimal solution faster</strong>. Why is this the case? Think of the solver as a tree: constraints help it trim branches and reduce the search space.</p>
<p>In our case, we have a limited number of resources we can use to produce units. In other words, <strong>we can't spend more resources than we have</strong>. For instance, the 🌾food spent to recruit units cannot be higher than 1200. The same is true with 🪵wood (800) and 🪙gold (600).</p>
<p>According to our table, units have the following costs:</p>
<ul>
<li>1 <strong>swordsman</strong> = 🌾60 + 🪵20;</li>
<li>1 <strong>bowman</strong> = 🌾80 + 🪵10 + 🪙40;</li>
<li>1 <strong>horseman</strong> = 🌾140 + 🪙100.</li>
</ul>
<p>We can write one constraint per resource as follows:</p>
$$60\times swordsmen + 80\times bowmen + 140\times horsemen \leq 1200 \\
20\times swordsmen + 10\times bowmen \leq 800 \\
40\times bowmen + 100\times horsemen \leq 600$$<p>In OR-Tools, we simply add the constraints to our solver instance with <code>solver.Add()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">swordsmen</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="n">bowmen</span><span class="o">*</span><span class="mi">80</span> <span class="o">+</span> <span class="n">horsemen</span><span class="o">*</span><span class="mi">140</span> <span class="o">&lt;=</span> <span class="mi">1200</span><span class="p">)</span> <span class="c1"># Food</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">swordsmen</span><span class="o">*</span><span class="mi">20</span> <span class="o">+</span> <span class="n">bowmen</span><span class="o">*</span><span class="mi">10</span> <span class="o">&lt;=</span> <span class="mi">800</span><span class="p">)</span>                 <span class="c1"># Wood</span>
<span class="n">solver</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bowmen</span><span class="o">*</span><span class="mi">40</span> <span class="o">+</span> <span class="n">horsemen</span><span class="o">*</span><span class="mi">100</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">)</span>                 <span class="c1"># Gold</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#127919;-IV.-Objective">&#127919; IV. Objective<a class="anchor-link" href="#&#127919;-IV.-Objective"> </a></h2><p>Now that we have our variables and constraints, we want to <strong>define our goal</strong> (or objective function).</p>
<p>In linear programming, this function <strong>has to be linear</strong> (like the constraints), so of the form $ax + by + cz + d$. In our example, the objective is quite clear: we want to recruit the army with the highest power. The table gives us the following power values:</p>
<ul>
<li>1 <strong>swordsman</strong> = 💪70;</li>
<li>1 <strong>bowman</strong> = 💪95;</li>
<li>1 <strong>horseman</strong> = 💪230.</li>
</ul>
<p>Maximizing the power of the army amounts to <strong>maximizing the sum of the power of each unit</strong>. Our objective function can be written as:</p>
<p>
$$max\ 70\times swordsmen + 95\times bowmen + 230\times horsemen$$
</p>
<p>In general, there are two types of objective functions: <strong>maximizing</strong> and <strong>minimizing</strong>. In OR-Tools, we declare this goal with <code>solver.Maximize()</code> or <code>solver.Minimize()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">solver</span><span class="o">.</span><span class="n">Maximize</span><span class="p">(</span><span class="n">swordsmen</span><span class="o">*</span><span class="mi">70</span> <span class="o">+</span> <span class="n">bowmen</span><span class="o">*</span><span class="mi">95</span> <span class="o">+</span> <span class="n">horsemen</span><span class="o">*</span><span class="mi">230</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we're done! There are three steps to model any linear optimization problem:</p>
<ol>
<li>Declaring the <strong>variables</strong> to optimize with lower and upper bounds;</li>
<li>Adding <strong>constraints</strong> to these variables;</li>
<li>Defining the <strong>objective function</strong> to maximize or to minimize.</li>
</ol>
<p>Now that is clear, we can ask the solver to find an optimal solution for us.</p>
<h2 id="&#129351;-V.-Optimize!">&#129351; V. Optimize!<a class="anchor-link" href="#&#129351;-V.-Optimize!"> </a></h2><p>Calculating the optimal solution is done with <code>solver.Solve()</code>. This function returns a status that can be used to <strong>check that the solution is indeed optimal</strong>.</p>
<p>Let's print the highest total power we can get with the best army configuration.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">status</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">Solve</span><span class="p">()</span>

<span class="c1"># If an optimal solution has been found, print results</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">pywraplp</span><span class="o">.</span><span class="n">Solver</span><span class="o">.</span><span class="n">OPTIMAL</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;================= Solution =================&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Solved in </span><span class="si">{</span><span class="n">solver</span><span class="o">.</span><span class="n">wall_time</span><span class="p">()</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> milliseconds in </span><span class="si">{</span><span class="n">solver</span><span class="o">.</span><span class="n">iterations</span><span class="p">()</span><span class="si">}</span><span class="s1"> iterations&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">()</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Optimal power = </span><span class="si">{</span><span class="n">solver</span><span class="o">.</span><span class="n">Objective</span><span class="p">()</span><span class="o">.</span><span class="n">Value</span><span class="p">()</span><span class="si">}</span><span class="s1"> 💪power&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Army:&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - 🗡️Swordsmen = </span><span class="si">{</span><span class="n">swordsmen</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - 🏹Bowmen = </span><span class="si">{</span><span class="n">bowmen</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; - 🐎Horsemen = </span><span class="si">{</span><span class="n">horsemen</span><span class="o">.</span><span class="n">solution_value</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The solver could not find an optimal solution.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>================= Solution =================
Solved in 87.00 milliseconds in 2 iterations

Optimal power = 1800.0 💪power
Army:
 - 🗡️Swordsmen = 6.0000000000000036
 - 🏹Bowmen = 0.0
 - 🐎Horsemen = 5.999999999999999
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great! The solver found an optimal solution: our army has a <strong>total power of 💪1800</strong> with 6 🗡️swordsmen and 6 🐎horsemen (sorry bowmen!).</p>
<p>Let's unpack this result:</p>
<ul>
<li>The solver decided to take the <strong>maximum number of 🐎horsemen</strong> (6, since we only have 🪙600 and they each cost 🪙100);</li>
<li>The remaining resources are spent in 🗡️<strong>swordsmen</strong>: we have $1200 – 6*140 = 360$🌾food left, which is why the solver chose 6 🗡️swordsmen;</li>
<li>We can deduce that the horsemen are the best unit and the <strong>bowmen are the worst one</strong> because they haven't been chosen at all.</li>
</ul>
<p>Okay, but there's something quite weird: these numbers are not round, even though we specified that we wanted <strong>integers</strong> (<code>IntVar</code>). So what happened?</p>
<p>Unfortunately, answering this question requires a deep dive into linear programming… To keep things simple in this introduction, let's say it's because of GLOP. Solvers have characteristics we have to take into account, and <strong>GLOP doesn't handle integers</strong>. This is another proof that building reusable models is more than just convenient.</p>
<p>We'll explain why GLOP has this strange behavior and <strong>how to fix it</strong> in a <a href="https://mlabonne.github.io/blog/integerprogramming/">more advanced tutorial</a>.</p>
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion"> </a></h2><p>We saw through this example the five main steps of any linear optimization problem:</p>
<ol>
<li><strong>Choosing a solver</strong>: in our case, we selected GLOP for convenience.</li>
<li><strong>Declaring variables</strong>: the parameters to optimize were the number of swordsmen, bowmen, and horsemen.</li>
<li><strong>Declaring constraints</strong>: each of these units has a cost. The total cost could not exceed our limited resources.</li>
<li><strong>Defining objective</strong>: the criterion to maximize was the total power of this army. It could have been something else, like the number of units.</li>
<li><strong>Optimizing</strong>: GLOP found an optimal solution to this problem in less than a second.</li>
</ol>
<center><img src="https://mlabonne.github.io/blog/images/linearoptimization/infographic.png" width="600" /></center><p>This is the main benefit of linear programming: the algorithm gives us a <strong>guarantee that the solution that was found is optimal</strong> (with a certain error). This guarantee is powerful, but comes at a cost: the model can be so complex that the solver takes years (or more) to find an optimal solution. In this scenario, we have two options:</p>
<ul>
<li>We can <strong>stop the solver</strong> after a certain time (and probably obtain a suboptimal answer);</li>
<li>We can use a <strong>metaheuristic</strong> like a genetic algorithm to calculate an excellent solution in a short amount of time.</li>
</ul>
<p>In the next article, we'll talk about the different types of optimization problems and generalize our approach to an entire class of them.</p>
<p>I hope you enjoyed this introduction! Feel free to share it and spread the knowledge about linear optimization. <a href="https://twitter.com/maximelabonne"><strong>Let's connect on Twitter</strong></a> where I post summaries of these articles. Cheers!</p>
<h2 id="&#129351;-Linear-Programming-Course">&#129351; Linear Programming Course<a class="anchor-link" href="#&#129351;-Linear-Programming-Course"> </a></h2><p><a href="https://github.com/mlabonne/Linear-Programming-Course" class="related">📚 Course syllabus</a></p>
<p><a href="https://mlabonne.github.io/blog/linearoptimization/" class="related">📝 Chapter 1: Introduction to Linear Programming</a></p>
<p><a href="https://mlabonne.github.io/blog/integerprogramming/" class="related">📝 Chapter 2: Integer vs. Linear Programming</a></p>
<p><a href="https://mlabonne.github.io/blog/constraintprogramming/" class="related">📝 Chapter 3: Constraint Programming</a></p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="mlabonne/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/linearoptimization/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Maxime Labonne</li>
          
        </ul>
      </div>
      <div class="footer-col">
        <p>Illustrated machine learning and deep learning tutorials with Python and PyTorch for programmers.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/mlabonne" target="_blank" title="mlabonne"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/maxime-labonne" target="_blank" title="maxime-labonne"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/maximelabonne" target="_blank" title="maximelabonne"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
